var ajax = function (request) {
    var r = new XMLHttpRequest()
    // 设置请求方法和请求地址
    r.open(request.method, request.path, true)
    // 设置发送的数据的格式
    // if(request.contentType != undefined){
    //     r.setRequestHeader('Content-Type', request.contentType)
    // }
    r.setRequestHeader('Content-Type', 'application/json')
    // 注册响应函数
    r.onreadystatechange = function() {
        if(r.readyState === 4) {
            // reseponseCallback 服务器返回的信息
            request.callback(r.response)
        }
    }
    // 判断发送请求发送请求
    if(request.method == 'get') {
        r.send()
    }else (
        r.send(request.data)
    )

}


//下面是echarts3的JS 代码
var echarts3 = function (data) {

    var myChart = echarts.init(document.getElementById('main'));

    var geoCoordMap = {
        "北京": [
            116.405285,
            39.904989
        ],
        "东城": [
            116.418757,
            39.917544
        ],
        "西城": [
            116.366794,
            39.915309
        ],
        "上海": [
            121.472644,
            31.231706
        ],
        "黄浦": [
            121.490317,
            31.222771
        ],
        "长宁": [
            104.921116,
            28.577271
        ],
        "静安": [
            121.448224,
            31.229003
        ],
        "普陀": [
            122.301953,
            29.945614
        ],
        "虹口": [
            121.491832,
            31.26097
        ],
        "杨浦": [
            121.522797,
            31.270755
        ],
        "天津": [
            117.190182,
            39.125596
        ],
        "和平": [
            114.941473,
            24.44318
        ],
        "河东": [
            118.398296,
            35.085004
        ],
        "河西": [
            117.217536,
            39.101897
        ],
        "南开": [
            117.164143,
            39.120474
        ],
        "河北": [
            117.201569,
            39.156632
        ],
        "红桥": [
            117.163301,
            39.175066
        ],
        "重庆": [
            108.170255,
            29.291965
        ],
        "渝中": [
            106.56288,
            29.556742
        ],
        "大渡口": [
            106.48613,
            29.481002
        ],
        "江北": [
            121.559282,
            29.888361
        ],
        "沙坪坝": [
            106.4542,
            29.541224
        ],
        "九龙坡": [
            106.480989,
            29.523492
        ],
        "南岸": [
            106.560813,
            29.523992
        ],
        "开州": [
            108.413317,
            31.167735
        ],
        "哈尔滨": [
            126.642464,
            45.756967
        ],
        "齐齐哈尔": [
            123.95792,
            47.342081
        ],
        "牡丹江": [
            129.618602,
            44.582962
        ],
        "佳木斯": [
            130.361634,
            46.809606
        ],
        "绥化": [
            126.99293,
            46.637393
        ],
        "黑河": [
            127.499023,
            50.249585
        ],
        "大兴安岭": [
            124.711526,
            52.335262
        ],
        "伊春": [
            128.899284,
            47.726851
        ],
        "大庆": [
            125.11272,
            46.590734
        ],
        "七台河": [
            131.015584,
            45.771266
        ],
        "鸡西": [
            130.975966,
            45.300046
        ],
        "鹤岗": [
            130.277487,
            47.332085
        ],
        "双鸭山": [
            131.157304,
            46.643442
        ],
        "长春": [
            125.3245,
            43.886841
        ],
        "吉林": [
            126.55302,
            43.843577
        ],
        "延边": [
            129.513228,
            42.904823
        ],
        "四平": [
            124.370785,
            43.170344
        ],
        "通化": [
            125.936501,
            41.721177
        ],
        "白城": [
            122.841114,
            45.619026
        ],
        "辽源": [
            125.145349,
            42.902692
        ],
        "松原": [
            124.823608,
            45.118243
        ],
        "白山": [
            126.427839,
            41.942505
        ],
        "沈阳": [
            123.429096,
            41.796767
        ],
        "大连": [
            121.618622,
            38.91459
        ],
        "鞍山": [
            122.995632,
            41.110626
        ],
        "抚顺": [
            124.097979,
            41.922644
        ],
        "本溪": [
            123.770519,
            41.297909
        ],
        "丹东": [
            124.383044,
            40.124296
        ],
        "锦州": [
            121.135742,
            41.119269
        ],
        "营口": [
            122.235151,
            40.667432
        ],
        "阜新": [
            121.743125,
            42.058607
        ],
        "辽阳": [
            123.18152,
            41.269402
        ],
        "铁岭": [
            123.725669,
            42.223316
        ],
        "朝阳": [
            120.451176,
            41.576758
        ],
        "盘锦": [
            122.06957,
            41.124484
        ],
        "葫芦岛": [
            120.856394,
            40.755572
        ],
        "呼和浩特": [
            111.670801,
            40.818311
        ],
        "包头": [
            109.840405,
            40.658168
        ],
        "乌海": [
            106.825563,
            39.673734
        ],
        "乌兰察布": [
            113.114543,
            41.034126
        ],
        "通辽": [
            122.263119,
            43.617429
        ],
        "赤峰": [
            118.956806,
            42.275317
        ],
        "鄂尔多斯": [
            109.99029,
            39.817179
        ],
        "巴彦淖尔": [
            107.416959,
            40.757402
        ],
        "锡林郭勒": [
            116.090996,
            43.944018
        ],
        "呼伦贝尔": [
            119.758168,
            49.215333
        ],
        "兴安盟": [
            122.070317,
            46.076268
        ],
        "阿拉善盟": [
            105.706422,
            38.844814
        ],
        "石家庄": [
            114.502461,
            38.045474
        ],
        "保定": [
            115.482331,
            38.867657
        ],
        "张家口": [
            114.884091,
            40.811901
        ],
        "承德": [
            117.939152,
            40.976204
        ],
        "唐山": [
            118.175393,
            39.635113
        ],
        "廊坊": [
            116.704441,
            39.523927
        ],
        "沧州": [
            116.857461,
            38.310582
        ],
        "衡水": [
            115.665993,
            37.735097
        ],
        "邢台": [
            114.561132,
            37.05073
        ],
        "邯郸": [
            114.490686,
            36.612273
        ],
        "秦皇岛": [
            119.586579,
            39.942531
        ],
        "太原": [
            112.549248,
            37.857014
        ],
        "大同": [
            113.301438,
            40.090511
        ],
        "阳泉": [
            113.583285,
            37.861188
        ],
        "晋中": [
            112.736465,
            37.696495
        ],
        "长治": [
            113.113556,
            36.191112
        ],
        "晋城": [
            112.851274,
            35.497553
        ],
        "临汾": [
            111.517973,
            36.08415
        ],
        "运城": [
            111.003957,
            35.022778
        ],
        "朔州": [
            112.433387,
            39.331261
        ],
        "忻州": [
            112.733538,
            38.41769
        ],
        "吕梁": [
            111.134335,
            37.524366
        ],
        "西安": [
            108.948024,
            34.263161
        ],
        "咸阳": [
            108.705117,
            34.333439
        ],
        "延安": [
            109.49081,
            36.596537
        ],
        "榆林": [
            109.741193,
            38.290162
        ],
        "渭南": [
            109.502882,
            34.499381
        ],
        "商洛": [
            109.939776,
            33.868319
        ],
        "安康": [
            109.029273,
            32.6903
        ],
        "汉中": [
            107.028621,
            33.077668
        ],
        "宝鸡": [
            107.14487,
            34.369315
        ],
        "铜川": [
            108.979608,
            34.916582
        ],
        "杨凌": [
            108.07,
            34.28
        ],
        "济南": [
            117.000923,
            36.675807
        ],
        "青岛": [
            120.355173,
            36.082982
        ],
        "淄博": [
            118.047648,
            36.814939
        ],
        "德州": [
            116.307428,
            37.453968
        ],
        "烟台": [
            121.391382,
            37.539297
        ],
        "潍坊": [
            119.107078,
            36.70925
        ],
        "济宁": [
            116.587245,
            35.415393
        ],
        "泰安": [
            117.129063,
            36.194968
        ],
        "临沂": [
            118.326443,
            35.065282
        ],
        "菏泽": [
            115.469381,
            35.246531
        ],
        "滨州": [
            118.016974,
            37.383542
        ],
        "东营": [
            118.507543,
            37.461567
        ],
        "威海": [
            122.116394,
            37.509691
        ],
        "枣庄": [
            117.557964,
            34.856424
        ],
        "日照": [
            119.461208,
            35.428588
        ],
        "莱芜": [
            117.677736,
            36.214397
        ],
        "聊城": [
            115.980367,
            36.456013
        ],
        "乌鲁木齐": [
            87.617733,
            43.792818
        ],
        "克拉玛依": [
            84.873946,
            45.595886
        ],
        "石河子": [
            86.041075,
            44.305886
        ],
        "昌吉": [
            87.304012,
            44.014577
        ],
        "吐鲁番": [
            89.184078,
            42.947613
        ],
        "巴音郭楞": [
            86.150969,
            41.768552
        ],
        "阿拉尔": [
            81.285884,
            40.541914
        ],
        "阿克苏": [
            80.265068,
            41.170712
        ],
        "喀什": [
            75.989138,
            39.467664
        ],
        "伊犁": [
            81.317946,
            43.92186
        ],
        "塔城": [
            82.983988,
            46.746281
        ],
        "哈密": [
            93.51316,
            42.833248
        ],
        "和田": [
            79.927542,
            37.108944
        ],
        "阿勒泰": [
            88.138743,
            47.848911
        ],
        "克州": [
            76.176796,
            39.713966
        ],
        "博尔塔拉": [
            82.074778,
            44.903258
        ],
        "图木舒克": [
            79.077978,
            39.867316
        ],
        "五家渠": [
            87.526884,
            44.167401
        ],
        "铁门关": [
            85.501218,
            41.827251
        ],
        "拉萨": [
            91.132212,
            29.660361
        ],
        "日喀则": [
            88.885148,
            29.267519
        ],
        "山南": [
            91.766529,
            29.236023
        ],
        "林芝": [
            94.362348,
            29.654693
        ],
        "昌都": [
            97.178452,
            31.136875
        ],
        "那曲": [
            92.060214,
            31.476004
        ],
        "阿里": [
            80.105498,
            32.503187
        ],
        "西宁": [
            101.778916,
            36.623178
        ],
        "海东": [
            102.10327,
            36.502916
        ],
        "黄南": [
            102.019988,
            35.517744
        ],
        "海南": [
            100.619542,
            36.280353
        ],
        "果洛": [
            100.242143,
            34.4736
        ],
        "玉树": [
            97.008522,
            33.004049
        ],
        "海西": [
            95.357233,
            37.853631
        ],
        "海北": [
            100.901059,
            36.959435
        ],
        "兰州": [
            103.823557,
            36.058039
        ],
        "定西": [
            104.626294,
            35.579578
        ],
        "平凉": [
            106.684691,
            35.54279
        ],
        "庆阳": [
            107.638372,
            35.734218
        ],
        "武威": [
            102.634697,
            37.929996
        ],
        "金昌": [
            102.187888,
            38.514238
        ],
        "张掖": [
            100.455472,
            38.932897
        ],
        "酒泉": [
            98.510795,
            39.744023
        ],
        "天水": [
            105.724998,
            34.578529
        ],
        "陇南": [
            104.929379,
            33.388598
        ],
        "临夏": [
            103.211634,
            35.59941
        ],
        "甘南": [
            102.911008,
            34.986354
        ],
        "白银": [
            104.173606,
            36.54568
        ],
        "嘉峪关": [
            98.277304,
            39.786529
        ],
        "银川": [
            106.278179,
            38.46637
        ],
        "石嘴山": [
            106.376173,
            39.01333
        ],
        "吴忠": [
            106.199409,
            37.986165
        ],
        "固原": [
            106.285241,
            36.004561
        ],
        "中卫": [
            105.189568,
            37.514951
        ],
        "郑州": [
            113.665412,
            34.757975
        ],
        "安阳": [
            114.352482,
            36.103442
        ],
        "新乡": [
            113.806186,
            35.190021
        ],
        "许昌": [
            113.826063,
            34.022956
        ],
        "平顶山": [
            113.307718,
            33.735241
        ],
        "信阳": [
            114.075031,
            32.123274
        ],
        "南阳": [
            112.540918,
            32.999082
        ],
        "开封": [
            114.341447,
            34.797049
        ],
        "洛阳": [
            112.434468,
            34.663041
        ],
        "商丘": [
            115.650497,
            34.437054
        ],
        "焦作": [
            113.238266,
            35.23904
        ],
        "鹤壁": [
            114.295444,
            35.748236
        ],
        "濮阳": [
            115.041299,
            35.768234
        ],
        "周口": [
            114.649653,
            33.620357
        ],
        "漯河": [
            114.026405,
            33.575855
        ],
        "驻马店": [
            114.024736,
            32.980169
        ],
        "三门峡": [
            111.194099,
            34.777338
        ],
        "济源": [
            112.590047,
            35.090378
        ],
        "南京": [
            118.767413,
            32.041544
        ],
        "无锡": [
            120.301663,
            31.574729
        ],
        "镇江": [
            119.452753,
            32.204402
        ],
        "苏州": [
            120.619585,
            31.299379
        ],
        "南通": [
            120.864608,
            32.016212
        ],
        "扬州": [
            119.421003,
            32.393159
        ],
        "盐城": [
            120.139998,
            33.377631
        ],
        "徐州": [
            117.184811,
            34.261792
        ],
        "淮安": [
            119.021265,
            33.597506
        ],
        "连云港": [
            119.178821,
            34.600018
        ],
        "常州": [
            119.946973,
            31.772752
        ],
        "泰州": [
            119.915176,
            32.484882
        ],
        "宿迁": [
            118.275162,
            33.963008
        ],
        "武汉": [
            114.298572,
            30.584355
        ],
        "襄阳": [
            112.144146,
            32.042426
        ],
        "鄂州": [
            114.890593,
            30.396536
        ],
        "孝感": [
            113.926655,
            30.926423
        ],
        "黄冈": [
            114.879365,
            30.447711
        ],
        "黄石": [
            115.077048,
            30.220074
        ],
        "咸宁": [
            114.328963,
            29.832798
        ],
        "荆州": [
            112.23813,
            30.326857
        ],
        "宜昌": [
            111.290843,
            30.702636
        ],
        "恩施": [
            109.48699,
            30.283114
        ],
        "十堰": [
            110.787916,
            32.646907
        ],
        "神农架": [
            110.671525,
            31.744449
        ],
        "随州": [
            113.37377,
            31.717497
        ],
        "荆门": [
            112.204251,
            31.03542
        ],
        "天门": [
            113.165862,
            30.653061
        ],
        "仙桃": [
            113.453974,
            30.364953
        ],
        "潜江": [
            112.896866,
            30.421215
        ],
        "杭州": [
            120.153576,
            30.287459
        ],
        "湖州": [
            120.102398,
            30.867198
        ],
        "嘉兴": [
            120.750865,
            30.762653
        ],
        "宁波": [
            121.549792,
            29.868388
        ],
        "绍兴": [
            120.582112,
            29.997117
        ],
        "台州": [
            121.428599,
            28.661378
        ],
        "温州": [
            120.672111,
            28.000575
        ],
        "丽水": [
            119.921786,
            28.451993
        ],
        "金华": [
            119.649506,
            29.089524
        ],
        "衢州": [
            118.87263,
            28.941708
        ],
        "舟山": [
            122.106863,
            30.016028
        ],
        "合肥": [
            117.283042,
            31.86119
        ],
        "蚌埠": [
            117.363228,
            32.939667
        ],
        "芜湖": [
            118.376451,
            31.326319
        ],
        "淮南": [
            117.018329,
            32.647574
        ],
        "马鞍山": [
            118.507906,
            31.689362
        ],
        "安庆": [
            117.043551,
            30.50883
        ],
        "宿州": [
            116.984084,
            33.633891
        ],
        "阜阳": [
            115.819729,
            32.896969
        ],
        "亳州": [
            115.782939,
            33.869338
        ],
        "黄山": [
            118.317325,
            29.709239
        ],
        "滁州": [
            118.316264,
            32.303627
        ],
        "淮北": [
            116.794664,
            33.971707
        ],
        "铜陵": [
            117.816576,
            30.929935
        ],
        "宣城": [
            118.757995,
            30.945667
        ],
        "六安": [
            116.507676,
            31.752889
        ],
        "池州": [
            117.489157,
            30.656037
        ],
        "福州": [
            119.306239,
            26.075302
        ],
        "厦门": [
            118.11022,
            24.490474
        ],
        "宁德": [
            119.527082,
            26.65924
        ],
        "莆田": [
            119.007558,
            25.431011
        ],
        "泉州": [
            118.589421,
            24.908853
        ],
        "漳州": [
            117.661801,
            24.510897
        ],
        "龙岩": [
            117.02978,
            25.091603
        ],
        "三明": [
            117.635001,
            26.265444
        ],
        "南平": [
            118.178459,
            26.635627
        ],
        "钓鱼岛": [
            123.46,
            25.73
        ],
        "南昌": [
            115.892151,
            28.676493
        ],
        "九江": [
            115.992811,
            29.712034
        ],
        "上饶": [
            117.971185,
            28.44442
        ],
        "抚州": [
            116.358351,
            27.98385
        ],
        "宜春": [
            114.391136,
            27.8043
        ],
        "吉安": [
            114.986373,
            27.111699
        ],
        "赣州": [
            114.940278,
            25.85097
        ],
        "景德镇": [
            117.214664,
            29.29256
        ],
        "萍乡": [
            113.852186,
            27.622946
        ],
        "新余": [
            114.930835,
            27.810834
        ],
        "鹰潭": [
            117.033838,
            28.238638
        ],
        "长沙": [
            112.982279,
            28.19409
        ],
        "湘潭": [
            112.944052,
            27.82973
        ],
        "株洲": [
            113.151737,
            27.835806
        ],
        "衡阳": [
            112.607693,
            26.900358
        ],
        "郴州": [
            113.032067,
            25.793589
        ],
        "常德": [
            111.691347,
            29.040225
        ],
        "益阳": [
            112.355042,
            28.570066
        ],
        "娄底": [
            112.008497,
            27.728136
        ],
        "邵阳": [
            111.46923,
            27.237842
        ],
        "岳阳": [
            113.132855,
            29.37029
        ],
        "张家界": [
            110.479921,
            29.127401
        ],
        "怀化": [
            109.97824,
            27.550082
        ],
        "永州": [
            111.608019,
            26.434516
        ],
        "湘西": [
            109.739735,
            28.314296
        ],
        "贵阳": [
            106.713478,
            26.578343
        ],
        "遵义": [
            106.937265,
            27.706626
        ],
        "安顺": [
            105.932188,
            26.245544
        ],
        "黔南": [
            107.517156,
            26.258219
        ],
        "黔东南": [
            107.977488,
            26.583352
        ],
        "铜仁": [
            109.191555,
            27.718346
        ],
        "毕节": [
            105.28501,
            27.301693
        ],
        "六盘水": [
            104.846743,
            26.584643
        ],
        "黔西南": [
            104.897971,
            25.08812
        ],
        "成都": [
            104.065735,
            30.659462
        ],
        "攀枝花": [
            101.716007,
            26.580446
        ],
        "自贡": [
            104.773447,
            29.352765
        ],
        "绵阳": [
            104.741722,
            31.46402
        ],
        "南充": [
            106.082974,
            30.795281
        ],
        "达州": [
            107.502262,
            31.209484
        ],
        "遂宁": [
            105.571331,
            30.513311
        ],
        "广安": [
            106.633369,
            30.456398
        ],
        "巴中": [
            106.753669,
            31.858809
        ],
        "泸州": [
            105.443348,
            28.889138
        ],
        "宜宾": [
            104.630825,
            28.760189
        ],
        "内江": [
            105.066138,
            29.58708
        ],
        "资阳": [
            104.641917,
            30.122211
        ],
        "乐山": [
            103.761263,
            29.582024
        ],
        "眉山": [
            103.831788,
            30.048318
        ],
        "凉山": [
            102.258746,
            27.886762
        ],
        "雅安": [
            103.001033,
            29.987722
        ],
        "甘孜": [
            101.963815,
            30.050663
        ],
        "阿坝": [
            102.221374,
            31.899792
        ],
        "德阳": [
            104.398651,
            31.127991
        ],
        "广元": [
            105.829757,
            32.433668
        ],
        "广州": [
            113.280637,
            23.125178
        ],
        "韶关": [
            113.591544,
            24.801322
        ],
        "惠州": [
            114.412599,
            23.079404
        ],
        "梅州": [
            116.117582,
            24.299112
        ],
        "汕头": [
            116.708463,
            23.37102
        ],
        "深圳": [
            114.085947,
            22.547
        ],
        "珠海": [
            113.553986,
            22.224979
        ],
        "佛山": [
            113.122717,
            23.028762
        ],
        "肇庆": [
            112.472529,
            23.051546
        ],
        "湛江": [
            110.364977,
            21.274898
        ],
        "江门": [
            113.094942,
            22.590431
        ],
        "河源": [
            114.697802,
            23.746266
        ],
        "清远": [
            113.051227,
            23.685022
        ],
        "云浮": [
            112.044439,
            22.929801
        ],
        "潮州": [
            116.632301,
            23.661701
        ],
        "东莞": [
            113.746262,
            23.046237
        ],
        "中山": [
            113.382391,
            22.521113
        ],
        "阳江": [
            111.975107,
            21.859222
        ],
        "揭阳": [
            116.355733,
            23.543778
        ],
        "茂名": [
            110.919229,
            21.659751
        ],
        "汕尾": [
            115.364238,
            22.774485
        ],
        "昆明": [
            102.712251,
            25.040609
        ],
        "大理": [
            100.225668,
            25.589449
        ],
        "红河": [
            103.384182,
            23.366775
        ],
        "曲靖": [
            103.797851,
            25.501557
        ],
        "保山": [
            99.167133,
            25.111802
        ],
        "文山": [
            104.24401,
            23.36951
        ],
        "玉溪": [
            102.543907,
            24.350461
        ],
        "楚雄": [
            101.546046,
            25.041988
        ],
        "普洱": [
            100.972344,
            22.777321
        ],
        "昭通": [
            103.717216,
            27.336999
        ],
        "临沧": [
            100.08697,
            23.886567
        ],
        "怒江": [
            98.854304,
            25.850949
        ],
        "迪庆": [
            99.706463,
            27.826853
        ],
        "丽江": [
            100.233026,
            26.872108
        ],
        "德宏": [
            98.578363,
            24.436694
        ],
        "西双版纳": [
            100.797941,
            22.001724
        ],
        "南宁": [
            108.320004,
            22.82402
        ],
        "崇左": [
            107.353926,
            22.404108
        ],
        "柳州": [
            109.411703,
            24.314617
        ],
        "来宾": [
            109.229772,
            23.733766
        ],
        "桂林": [
            110.299121,
            25.274215
        ],
        "梧州": [
            111.297604,
            23.474803
        ],
        "贺州": [
            111.552056,
            24.414141
        ],
        "贵港": [
            109.602146,
            23.0936
        ],
        "玉林": [
            110.154393,
            22.63136
        ],
        "百色": [
            106.616285,
            23.897742
        ],
        "钦州": [
            108.624175,
            21.967127
        ],
        "河池": [
            108.062105,
            24.695899
        ],
        "北海": [
            109.119254,
            21.473343
        ],
        "防城港": [
            108.345478,
            21.614631
        ],
        "海口": [
            110.33119,
            20.031971
        ],
        "三亚": [
            109.508268,
            18.247872
        ],
        "东方": [
            108.653789,
            19.10198
        ],
        "临高": [
            109.687697,
            19.908293
        ],
        "澄迈": [
            110.007147,
            19.737095
        ],
        "儋州": [
            109.576782,
            19.517486
        ],
        "昌江": [
            109.053351,
            19.260968
        ],
        "白沙": [
            109.452606,
            19.224584
        ],
        "琼中": [
            109.839996,
            19.03557
        ],
        "定安": [
            110.349235,
            19.684966
        ],
        "屯昌": [
            110.102773,
            19.362916
        ],
        "琼海": [
            110.466785,
            19.246011
        ],
        "文昌": [
            110.753975,
            19.612986
        ],
        "保亭": [
            109.70245,
            18.636371
        ],
        "万宁": [
            110.388793,
            18.796216
        ],
        "陵水": [
            110.037218,
            18.505006
        ],
        "乐东": [
            109.175444,
            18.74758
        ],
        "五指山": [
            109.516662,
            18.776921
        ],
        "三沙": [
            112.34882,
            16.831039
        ],
        "香港": [
            114.177,
            22.307
        ],
        "澳门": [
            113.544,
            22.202
        ],
        "台北": [
            121.516,
            25.04
        ],
        "高雄": [
            120.276,
            22.619
        ],
        "台中": [
            120.67,
            24.144
        ]
    }



    var convertData = function (data) {
        var res = [];
        for (var i = 0; i < data.length; i++) {
            var geoCoord = geoCoordMap[data[i].name];
            if (geoCoord) {
                res.push({
                    name: data[i].name,
                    value: geoCoord.concat(data[i].value)
                });
            }
        }
        return res;
    };

    var convertedData = [
        convertData(data),
        convertData(data.sort(function (a, b) {
            return b.value - a.value;
        }).slice(0, 6))
    ];


    option = {
        backgroundColor: '#404a59',
        animation: true,
        animationDuration: 1000,
        animationEasing: 'cubicInOut',
        animationDurationUpdate: 1000,
        animationEasingUpdate: 'cubicInOut',
        title: [
            {
                text: '全国主要城市 AQI 空气质量指数',
                subtext: 'data from PM25.in',
                sublink: 'http://www.pm25.in',
                left: 'center',
                textStyle: {
                    color: '#fff'
                }
            },
            {
                id: 'statistic',
                right: 120,
                top: 40,
                width: 100,
                textStyle: {
                    color: '#fff',
                    fontSize: 16
                }
            }
        ],
        toolbox: {
            iconStyle: {
                normal: {
                    borderColor: '#fff'
                },
                emphasis: {
                    borderColor: '#b1e4ff'
                }
            }
        },
        brush: {
            outOfBrush: {
                color: '#abc'
            },
            brushStyle: {
                borderWidth: 2,
                color: 'rgba(0,0,0,0.2)',
                borderColor: 'rgba(0,0,0,0.5)',
            },
            seriesIndex: [0, 1],
            throttleType: 'debounce',
            throttleDelay: 300,
            geoIndex: 0
        },
        geo: {
            map: 'china',
            left: '10',
            right: '35%',
            center: [117.98561551896913, 31.205000490896193],
            zoom: 2.5,
            label: {
                emphasis: {
                    show: false
                }
            },
            roam: true,
            itemStyle: {
                normal: {
                    areaColor: '#323c48',
                    borderColor: '#111'
                },
                emphasis: {
                    areaColor: '#2a333d'
                }
            }
        },
        tooltip : {
            trigger: 'item'
        },
        grid: {
            right: 40,
            top: 100,
            bottom: 40,
            width: '30%'
        },
        xAxis: {
            type: 'value',
            scale: true,
            position: 'top',
            boundaryGap: false,
            splitLine: {show: false},
            axisLine: {show: false},
            axisTick: {show: false},
            axisLabel: {margin: 2, textStyle: {color: '#aaa'}},
        },
        yAxis: {
            type: 'category',
            name: 'TOP 20',
            nameGap: 16,
            axisLine: {show: false, lineStyle: {color: '#ddd'}},
            axisTick: {show: false, lineStyle: {color: '#ddd'}},
            axisLabel: {interval: 0, textStyle: {color: '#ddd'}},
            data: []
        },
        series : [
            {
                name: 'pm2.5',
                type: 'scatter',
                coordinateSystem: 'geo',
                data: convertedData[0],
                symbolSize: function (val) {
                    return Math.max(val[2] / 10, 8);
                },
                label: {
                    normal: {
                        formatter: '{b}',
                        position: 'right',
                        show: false
                    },
                    emphasis: {
                        show: true
                    }
                },
                itemStyle: {
                    normal: {
                        color: '#ddb926'
                    }
                }
            },
            {
                name: 'Top 5',
                type: 'effectScatter',
                coordinateSystem: 'geo',
                data: convertedData[1],
                symbolSize: function (val) {
                    return Math.max(val[2] / 10, 8);
                },
                showEffectOn: 'emphasis',
                rippleEffect: {
                    brushType: 'stroke'
                },
                hoverAnimation: true,
                label: {
                    normal: {
                        formatter: '{b}',
                        position: 'right',
                        show: true
                    }
                },
                itemStyle: {
                    normal: {
                        color: '#f4e925',
                        shadowBlur: 10,
                        shadowColor: '#333'
                    }
                },
                zlevel: 1
            },
            {
                id: 'bar',
                zlevel: 2,
                type: 'bar',
                symbol: 'none',
                itemStyle: {
                    normal: {
                        color: '#ddb926'
                    }
                },
                data: []
            }
        ]
    };




    setTimeout(function () {
        myChart.dispatchAction({
            type: 'brush',
            areas: [
                {
                    geoIndex: 0,
                    brushType: 'polygon',
                    coordRange: [[119.72,34.85],[119.68,34.85],[119.5,34.84],[119.19,34.77],[118.76,34.63],[118.6,34.6],[118.46,34.6],[118.33,34.57],[118.05,34.56],[117.6,34.56],[117.41,34.56],[117.25,34.56],[117.11,34.56],[117.02,34.56],[117,34.56],[116.94,34.56],[116.94,34.55],[116.9,34.5],[116.88,34.44],[116.88,34.37],[116.88,34.33],[116.88,34.24],[116.92,34.15],[116.98,34.09],[117.05,34.06],[117.19,33.96],[117.29,33.9],[117.43,33.8],[117.49,33.75],[117.54,33.68],[117.6,33.65],[117.62,33.61],[117.64,33.59],[117.68,33.58],[117.7,33.52],[117.74,33.5],[117.74,33.46],[117.8,33.44],[117.82,33.41],[117.86,33.37],[117.9,33.3],[117.9,33.28],[117.9,33.27],[118.09,32.97],[118.21,32.7],[118.29,32.56],[118.31,32.5],[118.35,32.46],[118.35,32.42],[118.35,32.36],[118.35,32.34],[118.37,32.24],[118.37,32.14],[118.37,32.09],[118.44,32.05],[118.46,32.01],[118.54,31.98],[118.6,31.93],[118.68,31.86],[118.72,31.8],[118.74,31.78],[118.76,31.74],[118.78,31.7],[118.82,31.64],[118.82,31.62],[118.86,31.58],[118.86,31.55],[118.88,31.54],[118.88,31.52],[118.9,31.51],[118.91,31.48],[118.93,31.43],[118.95,31.4],[118.97,31.39],[118.97,31.37],[118.97,31.34],[118.97,31.27],[118.97,31.21],[118.97,31.17],[118.97,31.12],[118.97,31.02],[118.97,30.93],[118.97,30.87],[118.97,30.85],[118.95,30.8],[118.95,30.77],[118.95,30.76],[118.93,30.7],[118.91,30.63],[118.91,30.61],[118.91,30.6],[118.9,30.6],[118.88,30.54],[118.88,30.51],[118.86,30.51],[118.86,30.46],[118.72,30.18],[118.68,30.1],[118.66,30.07],[118.62,29.91],[118.56,29.73],[118.52,29.63],[118.48,29.51],[118.44,29.42],[118.44,29.32],[118.43,29.19],[118.43,29.14],[118.43,29.08],[118.44,29.05],[118.46,29.05],[118.6,28.95],[118.64,28.94],[119.07,28.51],[119.25,28.41],[119.36,28.28],[119.46,28.19],[119.54,28.13],[119.66,28.03],[119.78,28],[119.87,27.94],[120.03,27.86],[120.17,27.79],[120.23,27.76],[120.3,27.72],[120.42,27.66],[120.52,27.64],[120.58,27.63],[120.64,27.63],[120.77,27.63],[120.89,27.61],[120.97,27.6],[121.07,27.59],[121.15,27.59],[121.28,27.59],[121.38,27.61],[121.56,27.73],[121.73,27.89],[122.03,28.2],[122.3,28.5],[122.46,28.72],[122.5,28.77],[122.54,28.82],[122.56,28.82],[122.58,28.85],[122.6,28.86],[122.61,28.91],[122.71,29.02],[122.73,29.08],[122.93,29.44],[122.99,29.54],[123.03,29.66],[123.05,29.73],[123.16,29.92],[123.24,30.02],[123.28,30.13],[123.32,30.29],[123.36,30.36],[123.36,30.55],[123.36,30.74],[123.36,31.05],[123.36,31.14],[123.36,31.26],[123.38,31.42],[123.46,31.74],[123.48,31.83],[123.48,31.95],[123.46,32.09],[123.34,32.25],[123.22,32.39],[123.12,32.46],[123.07,32.48],[123.05,32.49],[122.97,32.53],[122.91,32.59],[122.83,32.81],[122.77,32.87],[122.71,32.9],[122.56,32.97],[122.38,33.05],[122.3,33.12],[122.26,33.15],[122.22,33.21],[122.22,33.3],[122.22,33.39],[122.18,33.44],[122.07,33.56],[121.99,33.69],[121.89,33.78],[121.69,34.02],[121.66,34.05],[121.64,34.08]]
                }
            ]
        });
    }, 0);


    function renderBrushed(params) {
        var mainSeries = params.batch[0].selected[0];

        var selectedItems = [];
        var categoryData = [];
        var barData = [];
        var maxBar = 30;
        var sum = 0;
        var count = 0;

        for (var i = 0; i < mainSeries.dataIndex.length; i++) {
            var rawIndex = mainSeries.dataIndex[i];
            var dataItem = convertedData[0][rawIndex];
            var pmValue = dataItem.value[2];

            sum += pmValue;
            count++;

            selectedItems.push(dataItem);
        }

        selectedItems.sort(function (a, b) {
            return a.value[2] - b.value[2];
        });

        for (var i = 0; i < Math.min(selectedItems.length, maxBar); i++) {
            categoryData.push(selectedItems[i].name);
            barData.push(selectedItems[i].value[2]);
        }

        this.setOption({
            yAxis: {
                data: categoryData
            },
            xAxis: {
                axisLabel: {show: !!count}
            },
            title: {
                id: 'statistic',
                text: count ? '平均: ' + (sum / count).toFixed(4) : ''
            },
            series: {
                id: 'bar',
                data: barData
            }
        });
    }
    myChart.on('brushselected', renderBrushed);
    myChart.setOption(option);
// myChart.setOption(option);
}
var loadAqi = function(){
    var  request = {
        method: 'GET',
        path: '/waether/all',
        callback: function (response) {
            console.log(typeof response, response)
            var aqi = JSON.parse(response)
            echarts3(aqi)
        }
    }
    ajax(request)
}
loadAqi()